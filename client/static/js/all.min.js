/*! Copyright (c) 2013 Mustafa Ä°lhan released under the MIT license */
(function() {

    var LAST_DAY = 0,
        LAST_WEEK = 1,
        LAST_MONTH = 2,
        DATE = 3,
        WOEID = 4,
        LIMIT = 50;

    var history = LAST_DAY,
        woeid = 23424969,
        response;

    var datepickerState = 0,
        stopInitialAnimation = 0,
        activeTipsy = null;
    
    // Google Analytics events
    $('a, .btn').on('click', function () {
        ga('send', 'event', 'link', 'click', $(this).attr('id') || $(this).attr('class'));
    });

    window.onload = function() {
    
        /*
         * initialize date picker
         */
        $("#datepicker").datepicker({
            dateFormat: "dd.mm.y",
            minDate: new Date(1373576400000), // 12 July 2013 Fri
            maxDate: new Date(),
            onSelect: function(date) {
                setHistory(this, DATE);
            }
        });
        $("#datepicker").datepicker("setDate", new Date());

        /*
         * initialize trends
         */
        displayLoading();
        getTrends();
        
        /*
         * add moveToFront function to d3.js
         */
        d3.selection.prototype.moveToFront = function() {
            return this.each(function(){
            this.parentNode.appendChild(this);
            });
        };
    }
})();